---
title: "ETC2420 Group 53"
authors: "Sineth Wickramsinghe, Janiru Rathnapriya, Senuth Dias, Lawrence 
output: html_document
date: "2024-09-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(gridExtra)
library(MASS)

# Creates a histogram and smoothed histogram given a vector of values.
dataplot <- function(x, bins = 50, colour = "blue") {
  ggplot(tibble(x = x), aes(x = x, y = after_stat(density))) +
    geom_histogram(bins = bins, colour = colour, fill = colour, alpha = 0.2) +
    geom_density(colour = colour, fill = colour, alpha = 0.2) +
    theme_bw()
}
```

```{r Reading Bank Survey Data, echo=TRUE, eval=TRUE}
bank <- read_csv("banksurvey.csv")
```

## Task #1 

# Descriptive Statistics on Customer Income

```{r Descriptive Statistics}
summary(bank) 
sd(bank$income)
mean(bank$income)
```

```{r}
dataplot(bank$income)

normal_fit <- fitdistr(bank$income, "normal")
normal_fit %>% tidy()

gamma_fit <- fitdistr(bank$income, "gamma") 
gamma_fit %>% tidy()

exponential_fit <- fitdistr(bank$income, "exponential") 
exponential_fit %>% tidy()
```

```{r}
qqnorm(bank$income)
qqline(bank$income, col = "red")
```


```{r}
params_norm <- fitdistr(bank$income, "normal")$estimate
p_qq_norm <- ggplot(tibble(x = bank$income)) + 
  aes(sample = x) + 
  stat_qq(distribution = qnorm, dparams = params_norm) + 
  stat_qq_line(distribution = qnorm, dparams = params_norm, color = "black") + 
  theme(aspect.ratio = 1) + 
  theme_bw() + 
  xlab("Theoretical Quantities (normal distribution)") + 
  ylab("Sample (CBT score difference)")
p_qq_norm 
```


```{r}
params_exp <- fitdistr(bank$income, "exponential")$estimate
p_qq_norm <- ggplot(tibble(x = bank$income)) + 
  aes(sample = x) + 
  stat_qq(distribution = qexp, dparams = params_exp) + 
  stat_qq_line(distribution = qexp, dparams = params_exp, color = "black") + 
  theme(aspect.ratio = 1) + 
  theme_bw() + 
  xlab("Theoretical Quantities (exponential distribution)") + 
  ylab("Sample (CBT score difference)")
p_qq_norm 
```




##Task 2 

*Central Limit Theorem Based Confidence Interval* 

##Hello 